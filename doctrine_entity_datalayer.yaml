services:
  Apie\DoctrineEntityDatalayer\EntityReindexer:
    arguments:
      - '@Apie\DoctrineEntityDatalayer\OrmBuilder'
      - '@Apie\Core\Indexing\Indexer'

  Apie\DoctrineEntityDatalayer\Factories\DoctrineListFactory:
    arguments:
      - '@Apie\DoctrineEntityDatalayer\OrmBuilder'
      - '@Apie\DoctrineEntityDatalayer\Factories\EntityQueryFilterFactory'

  Apie\DoctrineEntityDatalayer\Factories\EntityQueryFilterFactory:

  Apie\DoctrineEntityDatalayer\DoctrineEntityDatalayer:
    arguments:
      - '@Apie\DoctrineEntityDatalayer\OrmBuilder'
      - '@Apie\DoctrineEntityDatalayer\EntityReindexer'
      - '@Apie\DoctrineEntityDatalayer\Factories\DoctrineListFactory'
    tags:
      - apie.datalayer
  Apie\DoctrineEntityDatalayer\OrmBuilder:
    public: true
    arguments:
      - '@Apie\DoctrineEntityConverter\OrmBuilder'
      - '%apie.doctrine.build_once%'
      - '%apie.doctrine.run_migrations%'
      - '%kernel.debug%'
      - '%kernel.cache_dir%/apie_proxies'
      - '@?Psr\Cache\CacheItemPoolInterface'
      - '%kernel.cache_dir%/apie_entities'
      - '%apie.doctrine.connection_params%'
      - '@?Doctrine\Common\EventManager'
      - '@?doctrine.dbal.debug_middleware.default'
